[2025-12-10 01:49:05,148] INFO - src.preprocessing.data_preprocessor - Khởi tạo DataPreprocessor: DataPreprocessor(target_col=Outcome, missing_numeric_strategy=median_by_outcome, outlier_strategy=winsorize, scaler=standard, encoding=onehot)
[2025-12-10 01:49:05,149] INFO - src.preprocessing.data_preprocessor - Đang load dữ liệu từ: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\data\raw\diabetes.csv
[2025-12-10 01:49:05,154] INFO - src.preprocessing.data_preprocessor - Dữ liệu load thành công. Shape: (768, 9)
[2025-12-10 01:49:05,155] INFO - src.preprocessing.data_preprocessor - Phân loại cột: numeric=['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI', 'DiabetesPedigreeFunction', 'Age', 'Outcome'], categorical=[], datetime=[]
[2025-12-10 01:49:05,156] INFO - src.preprocessing.data_preprocessor - Bắt đầu run_full_preprocessing. Tổng shape: (768, 9)
[2025-12-10 01:49:05,156] INFO - src.preprocessing.data_preprocessor - Cột Glucose có 5 giá trị 0 (coi là missing ẩn). Thay bằng NaN.
[2025-12-10 01:49:05,157] INFO - src.preprocessing.data_preprocessor - Cột BloodPressure có 35 giá trị 0 (coi là missing ẩn). Thay bằng NaN.
[2025-12-10 01:49:05,158] INFO - src.preprocessing.data_preprocessor - Cột SkinThickness có 227 giá trị 0 (coi là missing ẩn). Thay bằng NaN.
[2025-12-10 01:49:05,158] INFO - src.preprocessing.data_preprocessor - Cột Insulin có 374 giá trị 0 (coi là missing ẩn). Thay bằng NaN.
[2025-12-10 01:49:05,161] INFO - src.preprocessing.data_preprocessor - Cột BMI có 11 giá trị 0 (coi là missing ẩn). Thay bằng NaN.
[2025-12-10 01:49:05,167] INFO - src.preprocessing.data_preprocessor - Feature engineering hoàn tất. Shape mới: (768, 14)
[2025-12-10 01:49:05,170] INFO - src.preprocessing.data_preprocessor - Chia train/test xong. X_train: (614, 13), X_test: (154, 13)
[2025-12-10 01:49:05,172] INFO - src.preprocessing.data_preprocessor - Bắt đầu fit DataPreprocessor. Shape: (614, 14)
[2025-12-10 01:49:05,172] INFO - src.preprocessing.data_preprocessor - Phân loại cột: numeric=['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI', 'DiabetesPedigreeFunction', 'Age', 'Pregnancy_high', 'Glucose_x_BMI', 'Insulin_div_Glucose', 'Outcome'], categorical=['BMI_category', 'Age_group'], datetime=[]
[2025-12-10 01:49:05,175] INFO - src.preprocessing.data_preprocessor - Feature engineering hoàn tất. Shape mới: (614, 14)
[2025-12-10 01:49:05,179] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Pregnancies: {0: 2.0, 1: 4.0}
[2025-12-10 01:49:05,180] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Glucose: {0: 108.0, 1: 141.5}
[2025-12-10 01:49:05,182] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột BloodPressure: {0: 70.0, 1: 76.0}
[2025-12-10 01:49:05,182] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột SkinThickness: {0: 27.0, 1: 33.0}
[2025-12-10 01:49:05,183] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Insulin: {0: 100.0, 1: 168.0}
[2025-12-10 01:49:05,183] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột BMI: {0: 30.1, 1: 34.349999999999994}
[2025-12-10 01:49:05,183] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột DiabetesPedigreeFunction: {0: 0.3415, 1: 0.461}
[2025-12-10 01:49:05,184] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Age: {0: 27.0, 1: 36.0}
[2025-12-10 01:49:05,184] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Pregnancy_high: {0: 0.0, 1: 1.0}
[2025-12-10 01:49:05,184] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Glucose_x_BMI: {0: 3282.8999999999996, 1: 4985.7}
[2025-12-10 01:49:05,184] INFO - src.preprocessing.data_preprocessor - Imputer numeric (median_by_outcome) cột Insulin_div_Glucose: {0: 0.9070257012806522, 1: 1.1764705767012689}
[2025-12-10 01:49:05,190] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose.
[2025-12-10 01:49:05,194] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BloodPressure.
[2025-12-10 01:49:05,205] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột SkinThickness.
[2025-12-10 01:49:05,214] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin.
[2025-12-10 01:49:05,219] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BMI.
[2025-12-10 01:49:05,223] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose_x_BMI.
[2025-12-10 01:49:05,230] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin_div_Glucose.
[2025-12-10 01:49:05,231] INFO - src.preprocessing.data_preprocessor - Imputer categorical (most_frequent) cột BMI_category: Obese
[2025-12-10 01:49:05,232] INFO - src.preprocessing.data_preprocessor - Imputer categorical (most_frequent) cột Age_group: 21-30
[2025-12-10 01:49:05,232] INFO - src.preprocessing.data_preprocessor - Impute missing categorical cho cột BMI_category.
[2025-12-10 01:49:05,233] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Pregnancies: lower=-6.5000, upper=13.5000
[2025-12-10 01:49:05,235] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Glucose: lower=36.0000, upper=204.0000
[2025-12-10 01:49:05,238] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột BloodPressure: lower=40.0000, upper=104.0000
[2025-12-10 01:49:05,240] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột SkinThickness: lower=13.0000, upper=45.0000
[2025-12-10 01:49:05,241] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Insulin: lower=-2.0000, upper=270.0000
[2025-12-10 01:49:05,244] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột BMI: lower=14.3125, upper=49.8125
[2025-12-10 01:49:05,246] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột DiabetesPedigreeFunction: lower=-0.3464, upper=1.2306
[2025-12-10 01:49:05,248] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Age: lower=-1.5000, upper=66.5000
[2025-12-10 01:49:05,249] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Pregnancy_high: lower=-1.5000, upper=2.5000
[2025-12-10 01:49:05,251] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Glucose_x_BMI: lower=229.6375, upper=7544.1375
[2025-12-10 01:49:05,253] INFO - src.preprocessing.data_preprocessor - IQR bounds cho cột Insulin_div_Glucose: lower=0.5029, upper=1.5806
[2025-12-10 01:49:05,256] INFO - src.preprocessing.data_preprocessor - One-hot encoding hoàn tất. Shape mới: (614, 20)
[2025-12-10 01:49:05,258] INFO - src.preprocessing.data_preprocessor - Fit scaler (standard) cho các cột: ['Pregnancies', 'Glucose', 'BloodPressure', 'SkinThickness', 'Insulin', 'BMI', 'DiabetesPedigreeFunction', 'Age', 'Pregnancy_high', 'Glucose_x_BMI', 'Insulin_div_Glucose']
[2025-12-10 01:49:05,260] INFO - src.preprocessing.data_preprocessor - Đã lưu scaler vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\data\processed\scaler.joblib
[2025-12-10 01:49:05,262] INFO - src.preprocessing.data_preprocessor - Fit DataPreprocessor hoàn tất.
[2025-12-10 01:49:05,262] INFO - src.preprocessing.data_preprocessor - Bắt đầu transform dữ liệu. Shape: (614, 14)
[2025-12-10 01:49:05,265] INFO - src.preprocessing.data_preprocessor - Feature engineering hoàn tất. Shape mới: (614, 14)
[2025-12-10 01:49:05,270] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose.
[2025-12-10 01:49:05,275] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BloodPressure.
[2025-12-10 01:49:05,281] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột SkinThickness.
[2025-12-10 01:49:05,295] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin.
[2025-12-10 01:49:05,303] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BMI.
[2025-12-10 01:49:05,308] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose_x_BMI.
[2025-12-10 01:49:05,315] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin_div_Glucose.
[2025-12-10 01:49:05,316] INFO - src.preprocessing.data_preprocessor - Impute missing categorical cho cột BMI_category.
[2025-12-10 01:49:05,326] INFO - src.preprocessing.data_preprocessor - One-hot encoding hoàn tất. Shape mới: (614, 20)
[2025-12-10 01:49:05,329] INFO - src.preprocessing.data_preprocessor - Transform dữ liệu hoàn tất. Shape mới: (614, 20)
[2025-12-10 01:49:05,329] INFO - src.preprocessing.data_preprocessor - Bắt đầu transform dữ liệu. Shape: (154, 14)
[2025-12-10 01:49:05,331] INFO - src.preprocessing.data_preprocessor - Feature engineering hoàn tất. Shape mới: (154, 14)
[2025-12-10 01:49:05,333] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose.
[2025-12-10 01:49:05,337] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BloodPressure.
[2025-12-10 01:49:05,339] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột SkinThickness.
[2025-12-10 01:49:05,343] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin.
[2025-12-10 01:49:05,344] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột BMI.
[2025-12-10 01:49:05,346] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Glucose_x_BMI.
[2025-12-10 01:49:05,349] INFO - src.preprocessing.data_preprocessor - Impute missing numeric (median_by_outcome) cho cột Insulin_div_Glucose.
[2025-12-10 01:49:05,350] INFO - src.preprocessing.data_preprocessor - Impute missing categorical cho cột BMI_category.
[2025-12-10 01:49:05,359] INFO - src.preprocessing.data_preprocessor - One-hot encoding hoàn tất. Shape mới: (154, 20)
[2025-12-10 01:49:05,361] INFO - src.preprocessing.data_preprocessor - Transform dữ liệu hoàn tất. Shape mới: (154, 20)
[2025-12-10 01:49:05,381] INFO - src.preprocessing.data_preprocessor - Đã lưu dữ liệu processed vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\data\processed\pima_train_processed.parquet
[2025-12-10 01:49:05,385] INFO - src.preprocessing.data_preprocessor - Đã lưu dữ liệu processed vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\data\processed\pima_test_processed.parquet
[2025-12-10 01:49:05,386] INFO - src.modeling.model_trainer - Khởi tạo ModelTrainer với config: ModelTrainer(models=['log_reg', 'random_forest'], scoring_primary=f1, cv_splits=5, use_smote=False)
[2025-12-10 01:49:05,387] INFO - src.modeling.model_trainer - Bắt đầu run_training. X_train shape: (614, 19)
[2025-12-10 01:49:05,387] INFO - src.modeling.model_trainer - Huấn luyện model: log_reg
[2025-12-10 01:49:05,850] INFO - src.modeling.model_trainer - Hoàn tất CV cho log_reg. Best params: {'penalty': 'l1', 'C': 1.0}, best f1: 0.7989
[2025-12-10 01:49:05,852] INFO - src.modeling.model_trainer - Đã lưu model 'log_reg' vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\models\log_reg_best.joblib
[2025-12-10 01:49:05,865] INFO - src.modeling.model_trainer - Classification report trên test:
              precision    recall  f1-score   support

           0       0.93      0.77      0.84       100
           1       0.68      0.89      0.77        54

    accuracy                           0.81       154
   macro avg       0.80      0.83      0.80       154
weighted avg       0.84      0.81      0.82       154

[2025-12-10 01:49:05,865] INFO - src.modeling.model_trainer - Test metrics cho log_reg: {'accuracy': 0.8116883116883117, 'precision': 0.676056338028169, 'recall': 0.8888888888888888, 'f1': 0.768, 'roc_auc': np.float64(0.8524074074074075), 'tn': 77.0, 'fp': 23.0, 'fn': 6.0, 'tp': 48.0}
[2025-12-10 01:49:05,866] INFO - src.modeling.model_trainer - Huấn luyện model: random_forest
[2025-12-10 01:49:36,699] INFO - src.modeling.model_trainer - Hoàn tất CV cho random_forest. Best params: {'n_estimators': 200, 'min_samples_split': 2, 'max_depth': 5}, best f1: 0.8422
[2025-12-10 01:49:36,792] INFO - src.modeling.model_trainer - Đã lưu model 'random_forest' vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\models\random_forest_best.joblib
[2025-12-10 01:49:36,826] INFO - src.modeling.model_trainer - Classification report trên test:
              precision    recall  f1-score   support

           0       0.94      0.88      0.91       100
           1       0.80      0.89      0.84        54

    accuracy                           0.88       154
   macro avg       0.87      0.88      0.87       154
weighted avg       0.89      0.88      0.88       154

[2025-12-10 01:49:36,827] INFO - src.modeling.model_trainer - Test metrics cho random_forest: {'accuracy': 0.8831168831168831, 'precision': 0.8, 'recall': 0.8888888888888888, 'f1': 0.8421052631578947, 'roc_auc': np.float64(0.9553703703703703), 'tn': 88.0, 'fp': 12.0, 'fn': 6.0, 'tp': 48.0}
[2025-12-10 01:49:36,827] INFO - src.modeling.model_trainer - Model tốt nhất trên test theo f1: random_forest (score=0.8421)
[2025-12-10 01:49:36,830] INFO - src.modeling.model_trainer - Đã ghi toàn bộ test metrics vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\results\experiments.csv
[2025-12-10 01:49:36,831] INFO - src.modeling.model_trainer - Đã ghi model tốt nhất và metrics vào: E:\3_CODING\Python\Python cho kdl\PRO\PT\pima-diabetes-project\results\best_model.txt
